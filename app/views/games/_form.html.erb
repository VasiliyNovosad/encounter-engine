<%= tinymce language: 'uk' %>
<div class="form-group row">
  <%= f.label :name, class: 'col-sm-2 col-form-label' %>
  <div class="col-sm-10">
    <%= f.text_field :name, class: 'form-control form-control-sm' %>
  </div>
</div>
<div class="form-group row">
  <%= f.label :description, class: 'col-sm-2 col-form-label' %>
  <div class="col-sm-10">
    <%= f.text_area :description, class: 'tinymce' %>
  </div>
</div>
<div class="form-group row">
  <%= f.label :starts_at, class: 'col-sm-2 col-form-label' %>
  <div class="col-sm-10">
    <%= f.text_field :starts_at, value: @game.starts_at.nil? ? '' : @game.starts_at.strftime("%d.%m.%Y %H:%M"), class: 'form-control form-control-sm' %>
  </div>
</div>
<div class="form-group row">
  <%= f.label :authors, class: 'col-sm-2 col-form-label' %>
  <div class="col-sm-10">
    <%= select_tag :organizing_team, options_from_collection_for_select(User.order(:nickname).all, 'id', 'nickname', @game.authors.map{ |j| j.id }), multiple: true, size: 5, class: 'form-control form-control-sm' %>
  </div>
</div>
<div class="form-group row">
  <%= f.label :registration_deadline, class: 'col-sm-2 col-form-label' %>
  <div class="col-sm-10">
    <%= f.text_field :registration_deadline, value: @game.registration_deadline.nil? ? '' : @game.registration_deadline.strftime("%d.%m.%Y %H:%M"), class: 'form-control form-control-sm' %>
  </div>
</div>
<div class="form-group row">
  <label for="max_team_checkbox" class="col-sm-2 col-form-label">Обмежити кількість команд</label>
  <div class="col-sm-1 col-2">
    <div class="form-check">
      <input id="max_team_checkbox" type="checkbox" onclick="toggle(this)" class="form-check-input"/>
    </div>
  </div>
  <div class="col-sm-9 col-10">
    <%= f.number_field :max_team_number, class: 'form-control form-control-sm' %>
  </div>
</div>
<div class="form-group row">
  <%= f.label :is_draft, class: 'col-sm-2 col-form-label' %>
  <div class="col-sm-10">
    <div class="form-check">
      <%= f.check_box :is_draft, class: 'form-check-input' %>
    </div>
  </div>
</div>
<div class="form-group row">
  <%= f.label :game_size, class: 'col-sm-2 col-form-label' %>
  <div class="col-sm-10">
    <%= f.select(:game_size, [['Лайт', 'Лайт'], ['Драйв', 'Драйв'], ['Онлайн', 'Онлайн']], {}, { class: 'form-control form-control-sm' }) %>
  </div>
</div>
<div class="form-group row">
  <%= f.label :game_type, class: 'col-sm-2 col-form-label' %>
  <div class="col-sm-10">
    <%= f.select(:game_type, [['Лінійна', 'linear'], ['Штурм', 'panic'], ['Лінійна (вказана)', 'selected']], {}, { class: 'form-control form-control-sm' }) %>
  </div>
</div>
<div class="form-group row" id="duration-block">
  <%= f.label :duration, class: 'col-sm-2 col-form-label' %>
  <div class="col-sm-3">
    <%= f.number_field :duration, class: 'form-control form-control-sm' %>
  </div>
  <div class="col-sm-7">
    <label class="col-form-label">хв</label>
  </div>
</div>

<script type="text/javascript">
    $('#game_starts_at').datetimepicker({
        format:'d.m.Y H:i',
        lang:'uk' });
    $('#game_registration_deadline').datetimepicker({
        format:'d.m.Y H:i',
        lang:'uk' });

    function toggle(sourceCheckbox) {
        if (sourceCheckbox.checked) {
            $('#game_max_team_number').css('display', 'block');
            $('#game_max_team_number').focus();
        }
        else {
            $('#game_max_team_number').css('display', 'none');
            $('#game_max_team_number').val(0);
        }
    }

    $('#game_game_type').on('change', function() {
        console.log('change');
        if ($('#game_game_type').val() == 'panic') {
            $('#duration-block').css('display', 'flex');
        } else {
            $('#duration-block').css('display', 'none');
        }
    });

    document.addEventListener("DOMContentLoaded", function(event) {
        if ($('#game_game_type').val() != 'panic') {
            $('#duration-block').css('display', 'none');
        }
        if ($('#game_max_team_number').val() == 0 || $('#game_max_team_number').val == 10000) {
            $('#max_team_checkbox').prop('checked', false);
            $('#game_max_team_number').css('display', 'none');
        } else {
            $('#max_team_checkbox').prop('checked', true);
            $('#game_max_team_number').css('display', 'block');
        }
    });
</script>