<h1>Статистика гри "<%= link_to @game.name, game_path(@game) %>"</h1>

<table id="stats" border="1">
  <thead>
    <tr align="center">
      <td></td>
      <% @levels.each do |level| %>
        <td>
          <%= "#{level.position}: #{level.name}" %>
        </td>
      <% end %>
      <td>Фінішний час</td>
      <td>Результат</td>
      <td></td>
    </tr>
  </thead>
  <tbody>
    <% @teams.count.times do |pos| %>
      <tr valign="top">
        <td align="center" valign="middle"><%= pos + 1 %></td>
        <% @levels.each do |level| %>
          <% log = @level_logs[level.position - 1][pos][:log] %>
          <td align="center">
            <% unless log.nil? %>
                <p class="team-name"><%= log.team %></p>
                <p>(<%= log.user.nickname %>)</p>
                <p><%= log.time.strftime('%d.%m.%Y') %></p>
                <p><%= log.time.strftime('%H:%M:%S') %></p>
                <% if log.answer == 'timeout' %>
                    <p class="timeout-stat">таймаут</p>
                <% end %>
            <% end %>
          </td>
        <% end %>
        <% log = @level_logs[@levels.count][pos] %>
        <!--{ team: result.team, levels: result.closed_levels.count, bonuses: result.sum_bonuses, time: result.finished_at || result.current_level_entered_at }-->
        <td align="center">
          <p class="team-name"><%= log[:team].name %>(<%= log[:levels] %>)</p>
          <p><%= log[:time].strftime('%d.%m.%Y') %></p>
          <p><%= log[:time].strftime('%H:%M:%S') %></p>
          <% if log[:bonuses] > 0 %>
              <p><%= "Бонус: #{log[:bonuses]} секунд" %></p>
          <% end %>
        </td>
        <% log1 = @level_logs[@levels.count + 1][pos] %>
        <td align="center">
          <p class="team-name"><%= log1[:team].name %>(<%= log1[:levels] %>)</p>
          <p><%= log1[:time].strftime('%d.%m.%Y') %></p>
          <p><%= log1[:time].strftime('%H:%M:%S') %></p>
        </td>
        <td align="center" valign="middle"><%= pos + 1 %></td>
      </tr>
    <% end %>
  </tbody>
</table>




<!--<table id="stats" border="1">-->
  <!--<tbody>-->
  <!--<% @levels.each do |level| %>-->
      <!--<tr align="center">-->
        <!--<td colspan="<%=@teams.count%>">-->
          <!--<h2><%= "#{level.position}. #{level.name}" %></h2>-->
        <!--</td>-->
      <!--</tr>-->
      <!--<tr valign="top">-->
        <!--<% @level_logs[level.position - 1].each do |level_log| %>-->
          <!--<% log = level_log[:log] %>-->
          <!--<td align="center">-->
            <!--<% unless log.nil? %>-->
              <!--<p class="team-name"><%= log.team %></p>-->
              <!--<p>(<%= log.user.nickname %>)</p>-->
              <!--<p><%= log.time.strftime('%d.%m.%Y') %></p>-->
              <!--<p><%= log.time.strftime('%H:%M:%S') %></p>-->
              <!--<% if log.answer == 'timeout' %>-->
                <!--<p class="timeout-stat">таймаут</p>-->
              <!--<% end %>-->
            <!--<% end %>-->
          <!--</td>-->
        <!--<% end %>-->
      <!--</tr>-->
  <!--<% end %>-->
  <!--</tbody>-->
<!--</table>-->